##################################
HPC4Stats/HPC4Stats.skeleton/batch
##################################
Douglas Nychka, douglasnychka@gmail.com
with modification from Dorit Hammerling, dorith@ucar.edu


This directory ("batch") contains the R namelist files that provide
information to the supervisor session.

template.rnl: Example of a namelist with comments indicating places to
add required and also optional information. This file will be sourced by R before the supervisor script is run so
it can contain assignments and R code as needed.

The subfolder abs contains template.pbs templateBig.pbs:
These are examples of a batch queueing files to run on Cheyenne. 
template.pbs selects 1 node and 35 workers/cores total to test Rmpi running on one node.
templateBig.pbs selects 2 node and 71 workers/cores total to test Rmpi running across 2 nodes.
NOTE: You will need to edit the project id on the line beginning with #PBS -A
to match your project id.  

To run as a simple batch job in the bash UNIX shell (on a local machine such as your laptop):

export HPC4StatsNAMELIST=template.rnl
R CMD BATCH --no-save ../src/supervisorBatch.R template.Rout

Make sure you are in the batch directory when executing these commands!

The export variable HPC4StatsNAMELIST is always necessary and is the
hook that enables the R script (batchSupervisor) to know what to do.
Once it has the right R namelist file then everything else follows
from this file's prescriptions. The name and location of the .rnl file
can be changed, however, make sure that any default directories are
changed as well. The number of workers and task ranges can be changed
by shell variables (see the comments in the template.rnl file for
details). We have found that running on Cheyenne it is more convenient
to change the number of workers and the task ranges as an environment variable
in the UNIX shell rather than continually reediting or copying the .rnl file.

 Finally to run as a serial code (only supervisor is doing tasks using a for loop).
 NOTE: Some of the output refers to the Rmpi settings but this just for debugging the R namelist file.

 export HPC4StatsNAMELIST=template.rnl
 R CMD BATCH --no-save ../src/supervisorBatchSerial.R templateSerial.Rout


